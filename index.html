<!DOCTYPE html>
<html>
<head>
  <title>AdPulse Guard – QA Demo (Single Scenario Mode)</title>

  <!-- CONFIG -->
  <script>
  window.APG_CONFIG = {
    clientId: "client_003",
    siteToken: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjbGllbnRJZCI6ImNsaWVudF8wMDMiLCJpYXQiOjE3NzA4MzcwMTcsImV4cCI6MTc3MjA0NjYxN30.uIjzRs1q_YkwcAw8RC5bwI8u2wfQyTz2rdD6xYvlR6c",
    allowedDomain: location.hostname,
    expectedNetworkId: "13051489"
  };
  </script>

  <!-- GPT -->
  <script async src="https://securepubads.g.doubleclick.net/tag/js/gpt.js"></script>

  <!-- ENGINE -->
  <script src="https://adpulse-guard.github.io/adpulse-guard/engine.js"></script>

  <style>
    body { font-family: Arial; padding: 40px; background:#f3f4f6; }
    h1 { margin-bottom: 20px; }
    button {
      display:block;
      margin:8px 0;
      padding:10px 14px;
      border:none;
      border-radius:6px;
      cursor:pointer;
      font-size:14px;
      color:white;
    }
    .red { background:#dc2626; }
    .orange { background:#f59e0b; }
    .yellow { background:#eab308; color:black; }
    .blue { background:#2563eb; }
    .purple { background:#7c3aed; }
    .brown { background:#92400e; }
    .gray { background:#374151; }
    #stage { margin-top:40px; min-height:300px; position:relative; }
  </style>
</head>

<body>

<h1>AdPulse Guard – QA Scenario Lab</h1>

<button class="red" onclick="scenario_wrongNetwork()">Wrong Network</button>
<button class="orange" onclick="scenario_emptyResponse()">Empty Response</button>
<button class="yellow" onclick="scenario_unexpectedSize()">Unexpected Size</button>
<button class="blue" onclick="scenario_gptNotLoaded()">GPT Not Loaded</button>
<button class="purple" onclick="scenario_slotNotRegistered()">Slot Not Registered</button>
<button class="brown" onclick="scenario_definedWithoutDom()">Defined Without DOM</button>
<button class="gray" onclick="scenario_layoutOverlap()">Layout Overlap</button>
<hr>
<button class="gray" onclick="scenario_multiple()">Multiple Issues Demo</button>

<div id="stage"></div>

<script>
window.googletag = window.googletag || {cmd:[]};

function hardReset() {
  document.getElementById("stage").innerHTML = "";

  if (window.googletag && googletag.apiReady) {
    googletag.destroySlots();
  }
}

/* Helper */
function createSlot(path, size, id) {
  const div = document.createElement("div");
  div.id = id;
  div.style.width = size[0] + "px";
  div.style.height = size[1] + "px";
  div.style.background = "#ddd";
  div.style.marginBottom = "20px";
  document.getElementById("stage").appendChild(div);

  googletag.cmd.push(function () {
    const slot = googletag.defineSlot(path, size, id)
      .addService(googletag.pubads());

    googletag.enableServices();
    googletag.display(id);
  });
}

/* ========================= */
/* SINGLE SCENARIO MODE     */
/* ========================= */

function scenario_wrongNetwork() {
  hardReset();
  createSlot('/99999/test', [300,250], 'div-gpt-ad-demo');
}

function scenario_emptyResponse() {
  hardReset();
  createSlot('/13051489/non_existing_path_12345', [300,250], 'div-gpt-ad-demo');
}

function scenario_unexpectedSize() {
  hardReset();
  createSlot('/13051489/test', [300,250], 'div-gpt-ad-demo');

  setTimeout(() => {
    const el = document.getElementById("div-gpt-ad-demo");
    el.style.width = "728px";
    el.style.height = "90px";
  }, 2000);
}

function scenario_gptNotLoaded() {
  hardReset();
  delete window.googletag;
  console.log("GPT removed before scan.");
}

function scenario_slotNotRegistered() {
  hardReset();

  const div = document.createElement("div");
  div.id = "div-gpt-ad-orphan";
  div.style.width = "300px";
  div.style.height = "250px";
  div.style.background = "#ddd";
  document.getElementById("stage").appendChild(div);
}

function scenario_definedWithoutDom() {
  hardReset();

  googletag.cmd.push(function () {
    googletag.defineSlot('/13051489/test', [300,250], 'nonexistent-div')
      .addService(googletag.pubads());
    googletag.enableServices();
  });
}

function scenario_layoutOverlap() {
  hardReset();

  const a = document.createElement("div");
  a.id = "div-gpt-ad-a";
  a.style.width = "300px";
  a.style.height = "250px";
  a.style.background = "#ccc";
  a.style.position = "absolute";
  a.style.top = "200px";
  a.style.left = "100px";

  const b = document.createElement("div");
  b.id = "div-gpt-ad-b";
  b.style.width = "300px";
  b.style.height = "250px";
  b.style.background = "#aaa";
  b.style.position = "absolute";
  b.style.top = "230px";
  b.style.left = "130px";

  document.getElementById("stage").appendChild(a);
  document.getElementById("stage").appendChild(b);

  googletag.cmd.push(function () {
    googletag.defineSlot('/13051489/test1', [300,250], 'div-gpt-ad-a')
      .addService(googletag.pubads());
    googletag.defineSlot('/13051489/test2', [300,250], 'div-gpt-ad-b')
      .addService(googletag.pubads());

    googletag.enableServices();
    googletag.display('div-gpt-ad-a');
    googletag.display('div-gpt-ad-b');
  });
}

/* ========================= */
/* MULTIPLE ISSUES DEMO     */
/* ========================= */

function scenario_multiple() {
  hardReset();

  // 1 wrong network
  createSlot('/99999/test', [300,250], 'div-gpt-ad-1');

  // 1 empty response
  createSlot('/13051489/non_existing_path', [300,250], 'div-gpt-ad-2');

  // 1 orphan DOM
  const orphan = document.createElement("div");
  orphan.id = "div-gpt-ad-orphan";
  orphan.style.width = "300px";
  orphan.style.height = "250px";
  orphan.style.background = "#ddd";
  document.getElementById("stage").appendChild(orphan);
}
</script>

</body>
</html>
